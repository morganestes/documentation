The upstream has the following directory structure:

```none:title=code/
code/
├─ .gitignore
├─ composer.json
└─ pantheon.upstream.yml
├─ README.md
└─ upstream-configuration/ or upstream-config/ for WordPress
   └─ composer.json
└─ web/
   └─ sites/ for Drupal
   └─ wp-content/ for WordPress
```

- `.gitignore`: Prevents build artifacts generated by Composer from being committed to the upstream or site code repositories. Note that changing the tracking status of composer-managed files and directories can result in build failures or lead to unexpected errors.
- `composer.json`: The two different `composer.json` files allow customization of individual sites without inherent merge conflicts and enable one-click updates.
  - Root-level: Site-level customizations.
  - Drupal: `upstream-configuration/` or WordPress: `upstream-config/`:
    - `composer.json`: Composer automatically updates `composer.json` with customizations for the upstream. Avoid manually modifying this file.
- `pantheon.upstream.yml`: The `build_step: true` directive in `pantheon.upstream.yml` enables the build step.

When a site is created, Pantheon runs `composer install`, generates a `composer.lock` file, and commits it back to the site’s code repository. To avoid potential merge conflicts after applying an upstream update, do not commit the `composer.lock` file to the upstream repository and instead add it to the `.gitignore` file.

Build artifacts are stored in a Git tag like `pantheon_build_artifacts_$BRANCHNAME`, where `$BRANCHNAME` is the name of the environment or Multidev feature branch.

It is a requirement that all build artifacts should be ignored in the `.gitignore` file. Ensure you add entries to the `.gitignore` any time you modify the build to move installation files to a new locations.
